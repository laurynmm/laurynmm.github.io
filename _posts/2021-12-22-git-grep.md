---
title: Using `git-grep`
date: 2021-12-22
---

Joining a project as a newcomer always requires learning the existing systems of that community. You're introduced to the folks you'll be working with, the workflows and routines used in day-to-day tasks, the internal lingo used to refer to the different aspects of the project, and much more.

One common hurdle of starting to contribute to many open-source sofware projects is navigating a project's codebase, which can be overwhelming for a new contributor. When I first looked at the cloned [Zulip git repository](https://github.com/zulip/zulip) on my local machine, I know that's how I felt.

![Image from 1999 film '10 Things I Hate about You' of Chastity asking Bianca if you can be 'whelmed'](/docs/assets/whelmed-gif.gif)

## Where to start?

An oft-repeated refrain in messages to new contributors asking where to start on addressing an issue from experienced Zulip folks is to use `git grep`.

Prior to Zulip, I hadn't heard of this git command line tool and learning to use it has been a huge help in gaining confidence contributing and becoming more knowledgable about the project. 

Here's my intro to using `git grep` to navigate a large and complex repository like Zulip's.

## Trying it out

I'll admit my first few attempts at using `git grep` were not successful. Just like googling, knowing what you're looking for is important. Most of the time, using it on a word (e.g. browser) or very general idea (e.g. stream_id) isn't going to be very helpful.

#### `git grep browser`
![Gif of screenshot of git grep browser](/docs/assets/Screenshot-git-grep-browser.png)

Here's the endless list of all the matches for the word 'browser' in the Zulip repository. Not useful for narrowing down where I might need to look to work on my issue.

#### `git grep stream_id`
![Gif of screenshot of git grep stream_id](/docs/assets/Screenshot-git-grep-stream-id.png)

Here's another endless list of all the matches for 'stream_id' in the Zulip repository. Not useful though 'stream_id' might be an important part of the code that you end up working on for your issue.

But with something more concrete to look for like a variable (e.g. `max_message_length`), function (e.g. `do_update_message`) or setting (e.g. `mandatory_topics`) from the project, you'll get a good idea of where to start reading and potentially working.

#### `git grep max_message_length`
![Screenshot of git grep max_message_length](/docs/assets/Screenshot-git-grep-max-message-length.png)

Here I've used `git grep` to match `max_message_length`, which refers to a setting (on both the frontend and backend) for messages in Zulip. This is useful because I now have a managable list of files to start looking at in the repository!

Note that without specifying the option to be case insensitive (-i) `git grep` doesn't match the all caps version `MAX_MESSAGE_LENGTH` in `zerver/lib/events.py`.

So, before you start using `git grep`, it's worth the time to do a little orientation about the task you're interested in via your project's resources, which for Zulip would be:
- [github 'good first' issues](https://github.com/zulip/zulip/labels/good%20first%20issue)
- [the development community](https://zulip.com/development-community/)
- [developer tutorials](https://zulip.readthedocs.io/en/latest/tutorials/index.html)

## Less is more

So, just plain `git grep` is great. On each line, you see the file path and the pattern match that was found. Here are the results I got when I was looking for the function `do_update_message` recently:

#### `git grep do_update_message`
![Screenshot of git grep do_update_message](/docs/assets/Screenshot-git-grep-do-update-message.png)

However, I only wanted a list of the files with matches to this function name, and the repetition of the match in `tests_event.py` and `tests_message_edit.py` made it harder for me to quickly get that information. 

Luckily, a quick read-through of the docs by calling `git help grep` or `man git grep` gave me a way to return a simplified view by using `git grep -c`.

#### `git grep -c do_update_message`
![Screenshot of git grep -c do_update_message](/docs/assets/Screenshot-git-grep-c-do-update-message.png)

This time, I've got a list of 7 files to look at and each line includes a count of how many times my pattern of `do_update_message` matched.

If you don't want the count, then use `git grep -l` for the same list (see screenshot below).

#### `git grep -l do_update_message`
![Screenshot of git grep -l do_update_message](/docs/assets/Screenshot-git-grep-l-do-update-message.png)

## Limit yourself to what you need

That's probably enough to get folks started, but here are a few more tips that could be useful as you get more familiar with your project's codebase.

After working on the project for a little while, I now know that the frontend implementation of Zulip's application features are in the `static/js` directory and that the help center documentation files are in the `templates/zerver/help` directory. 

So, if I want even more targeted searches with `git grep`, I can include the path in my searches to see only the files in those directories. Here's the generic call: `git grep <pattern> -- <path>`.

#### `git grep -c default_view -- :static/js`
![Screenshot of git grep -c default_view -- :static/js](/docs/assets/Screenshot-git-grep-default-view-static.png)

Here I've limited my search because I only want to look at where 'default_view' appears in the frontend implementation of Zulip's web application.

#### `git grep -l "default view" -- :templates/zerver/help`
![Screenshot of git grep -l default\\sview -- :templates/zerver/help](/docs/assets/Screenshot-git-grep-default-view-templates.png)

Here I've limited my search because I only want to find the help center markdown files that refer to 'default view'. Note that here I used the space escape character in my pattern to search for a space and not an underscore between the two words.

## A little bit of formatting goes a long way

Most of the time, we want to read through the code in our preferred IDE or source-code editor. But we can format our search results to get a little glimpse of the code with `git grep` in the terminal if we want.

Here are some of the `git grep` options we'll want to use:
- `--break` will print an empty line between matches from different files.
- `--heading` will show the file name on the line above the matches instead of the start of the line.
- `-n` will prefix the line number to the matching lines in the file.

And using them all together gives you a more readable output to the terminal. Here's a screenshot of all the matches for the admin setting used in the [Zulip tutorial for adding a new application feature](https://zulip.readthedocs.io/en/latest/tutorials/new-feature-tutorial.html):

#### `git grep --break --heading -n mandatory_topics`
![Screenshot of git grep --break --heading -n mandatory_topics](/docs/assets/Screenshot-git-grep-break-header-n-mandatory-topics.png)

## Summing up

This post only scratches the surface of using `git grep` and doesn't go into how it compares to other command line search tools. But hopefully it's enough to get some people started using it and curious to learn more. 

Definitely check out the official [`git grep` docs here](https://git-scm.com/docs/git-grep).

And here are two blog posts I found useful while writing this post that go into more options for using git grep than I go here:
- [Learn Git-Grep to Boost Your Command Line Search!](https://irian.to/blogs/learn-git-grep-to-boost-your-command-line-search/)
- [Search a git repo like a ninja](https://travisjeffery.com/b/2012/02/search-a-git-repo-like-a-ninja/)

![Heath Ledger dancing on high school stadium seats in 1999 film '10 Things I Hate about You'](/docs/assets/sing-me-a-love-song-performing.gif)