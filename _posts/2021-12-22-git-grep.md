---
title: Learning git-grep
date: 2021-12-22
---

One common hurdle of starting to contribute to many open-source sofware projects is navigating a large and complex codebase. I know that when I first looked at the cloned [Zulip git repository](https://github.com/zulip/zulip) on my local machine, I simply felt overwhelmed.

![Image from 1999 film '10 Things I Hate about You' of Chastity asking Bianca if you can be 'whelmed'](/docs/assets/whelmed-gif.gif)

## Where do I start?

An oft-repeated refrain from experienced Zulip folks in their replies to new contributors asking where to start on addressing an issue is to use `git-grep`.

Prior to Zulip, I hadn't heard of this git command line tool and learning to use it has been a huge help in gaining confidence contributing and becoming more knowledgable about Zulip. 

Here's my intro to using `git-grep` to navigate a large and complex repository like Zulip's.

## The basics

In short, `grep` is a command built into git that searches through the working directory (or committed tree) for a string or regular expression. It's fast, simple and very useful.

``` codeblock of git grep max_message_length ```

In the codeblock above, I've used `git-grep` to match `max_message_length`, which refers to a setting for messages in [Zulip](https://zulip.com/).

On each line of the terminal output, you see the file path and the pattern match that was found is in bold color. 

Now, if I want to work on some code that relates to this setting, I have a managable list of files to start looking at in the repository!

## Going beyond the basics

Just using `git-grep` is worthwhile, but here are a few ways to make your searches more effective and fruitful.

### Knowing what you're looking for

Most of the time, using `git-grep` on a general project related word or phrase, for example 'message' or 'stream_id' in Zulip's repositiory, isn't going to be very helpful. 

But, when you have something concrete to look for like a variable (e.g. `max_message_length`), function (e.g. `do_update_message`) or setting (e.g. `mandatory_topics`) from the project, you'll get a good idea of where to start reading and potentially working.

 I'll admit my first few attempts at using `git-grep` were not successful. I ended up with a few terminal outputs that were seemingly endless lists of matches in the Zulip codebase.

So, before you start using `git-grep`, it's worth the time to do a little orientation about the task or issue you're interested in via your project's resources.

If you're considering contributing to Zulip, I'd recommend:
- [github 'good first' issues](https://github.com/zulip/zulip/labels/good%20first%20issue)
- [the development community](https://zulip.com/development-community/)
- [developer tutorials](https://zulip.readthedocs.io/en/latest/tutorials/index.html)

### Case insensitivity

Remember my example above with `max_message_length`? Here it is again:

``` codeblock of git grep max_message_length ```

If you look closely, you'll see my call of `git grep max_message_length` didn't match the constant `MAX_MESSAGE_LENGTH` in `zerver/lib/events.py` due to the difference in capitalization. 

By adjusting my call to include the option for a case insensitive search (`-i`), the output below now includes the matches for when my pattern is a variable (lowercase) and when it's a constant (uppercase).

``` codeblock for git grep -i max_message_length ```

### When less is more

Here are the results I got when I was looking for the function `do_update_message` recently:

``` codeblock of git grep do_update_message ```

However, what I really needed was a list of the files with matches to this function name, and the repetition of the match in `tests_event.py` and `tests_message_edit.py` made it difficult for me to see that information quickly and clearly. 

Luckily, a quick read-through of the docs (by calling `git help grep` in the terminal) revealed a way to return a simplified view by using: `git grep -c`.

``` codeblock of git grep -c do_update_message ```

This time in the terminal output above, I've got a list of 7 files to look at and each line includes a count of how many times my pattern matched in each file.

And if you don't want or need the count in your output, then you can use: `git grep -l`.

``` codeblock of git grep -l do_update_message ```

### Limit yourself to what you need

After working on Zulip for a little while, I've learned that the frontend implementation of the application's features are in the `static/js` directory and that the help center documentation files are in the `templates/zerver/help` directory.

So, if I want even more targeted searches with `git-grep` in my working directory, I can include a path in my calls to see only the files in those specific directories. 

Here's a template call for specifying a directory path:
`git grep <pattern> -- <path>`.

``` codeblock of git grep -c default_view -- :static/js ```

In the codeblock above, I've limited my search to where `default_view` appears in the frontend implementation of Zulip's web application.

``` codeblock of git grep -l "default view" -- :templates/zerver/help ```

Similarly, in the code above are the matches to the string "default view" in the help center markdown files.

## A little bit of formatting goes a long way

Most of the time, I want to read through code in my preferred IDE. But sometimes I want to format my `git-grep` search results to get a little glimpse of the code in the terminal.

Here are some helpful options I've found:
- `--break`, which will print an empty line between matches from different files.
- `--heading`, which will show the file name on the line above the matches instead of the start of the line.
- `-n` or `--line-number`, which will prefix the line number to the matching lines in the file.

Combining these options will return a slighly 'formatted' output to the terminal. Below you can see the terminal output with these three `git-grep` options for the admin setting `mandatory_topics`, which is used in the [Zulip tutorial for adding a new application feature](https://zulip.readthedocs.io/en/latest/tutorials/new-feature-tutorial.html).

``` codeblock of git grep --break --heading -n mandatory_topics ```

## Summing up

This post only scratches the surface of using `git-grep` and doesn't go into how it compares to other command line search tools. But hopefully it's enough to get some people started using it and curious to learn more. 

Definitely check out the official [`git-grep` documentation here](https://git-scm.com/docs/git-grep).

And here are two blog posts I found useful while writing this post that go into more options for using `git-grep` than I do in this post:
- [Learn Git-Grep to Boost Your Command Line Search!](https://irian.to/blogs/learn-git-grep-to-boost-your-command-line-search/)
- [Search a git repo like a ninja](https://travisjeffery.com/b/2012/02/search-a-git-repo-like-a-ninja/)

![Heath Ledger dancing on high school stadium seats in 1999 film '10 Things I Hate about You'](/docs/assets/sing-me-a-love-song-performing.gif)